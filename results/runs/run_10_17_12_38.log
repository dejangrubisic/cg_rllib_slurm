Address Head: 100.97.65.171:6888
RAY_ADDRESS: auto
REDIS_PASSWORD: e65655d3-4201-4da7-b18b-190b74e1a6b5
Starting HEAD at learnfair0257
SUCCESS
Worker number = 0
Starting command: 
2022-10-17 12:40:49,547	INFO scripts.py:612 -- Local node IP: 100.97.65.171
2022-10-17 12:40:56,518	SUCC scripts.py:651 -- --------------------
2022-10-17 12:40:56,518	SUCC scripts.py:652 -- Ray runtime started.
2022-10-17 12:40:56,518	SUCC scripts.py:653 -- --------------------
2022-10-17 12:40:56,518	INFO scripts.py:655 -- Next steps
2022-10-17 12:40:56,518	INFO scripts.py:656 -- To connect to this Ray runtime from another node, run
2022-10-17 12:40:56,518	INFO scripts.py:660 --   ray start --address='100.97.65.171:6888' --redis-password='e65655d3-4201-4da7-b18b-190b74e1a6b5'
2022-10-17 12:40:56,518	INFO scripts.py:665 -- Alternatively, use the following Python code:
2022-10-17 12:40:56,519	INFO scripts.py:668 -- import ray
2022-10-17 12:40:56,519	INFO scripts.py:669 -- ray.init(address='auto', _redis_password='e65655d3-4201-4da7-b18b-190b74e1a6b5')
2022-10-17 12:40:56,519	INFO scripts.py:677 -- To connect to this Ray runtime from outside of the cluster, for example to
2022-10-17 12:40:56,519	INFO scripts.py:679 -- connect to a remote cluster from your laptop directly, use the following
2022-10-17 12:40:56,519	INFO scripts.py:681 -- Python code:
2022-10-17 12:40:56,520	INFO scripts.py:684 -- import ray
2022-10-17 12:40:56,520	INFO scripts.py:685 -- ray.init(address='ray://<head_node_ip_address>:10001')
2022-10-17 12:40:56,520	INFO scripts.py:691 -- If connection fails, check your firewall settings and network configuration.
2022-10-17 12:40:56,520	INFO scripts.py:696 -- To terminate the Ray runtime, run
2022-10-17 12:40:56,520	INFO scripts.py:697 --   ray stop
2022-10-17 12:40:56,520	INFO scripts.py:765 -- --block
2022-10-17 12:40:56,520	INFO scripts.py:766 -- This command will now block until terminated by a signal.
2022-10-17 12:40:56,521	INFO scripts.py:768 -- Running subprocesses are monitored and a message will be printed if any of them terminate unexpectedly.
Running with following CLI options: Namespace(debug=False, iter=2, local_mode=False, policy='', run='PPO', size=1000000, slurm=True, sweep=0)
SLURM options:  auto 100.97.65.171 e65655d3-4201-4da7-b18b-190b74e1a6b5
1017 12:41:17 ray.worker] Using address auto set in the environment variable RAY_ADDRESS
1017 12:41:17 compiler_gym.service.connection] Exec `./example_service.py --working_dir=/dev/shm/compiler_gym_dejang/s/1017T124117-820395-3b18 --alsologtostderr -v=1 --logbuflevel=-1`
1017 12:41:21 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/012345
Action space: NamedDiscrete([up, down, swap_up, swap_down])
Observation space: Box([[0. 0. 0. ... 0. 0. 0.]], [[1. 1. 1. ... 1. 1. 1.]], (1, 1160), float32)
Reward space: flops_loop_nest_tensor
Train params:  {'log_level': 'DEBUG', 'env': 'compiler_gym', 'framework': 'torch', 'model': {'custom_model': 'my_model', 'vf_share_layers': True, 'fcnet_hiddens': [512, 512, 512, 512]}, 'num_gpus': 1, 'rollout_fragment_length': 100, 'train_batch_size': 7900, 'num_sgd_iter': 50, 'explore': True, 'gamma': 0.9, 'lr': 1e-06, 'num_workers': 79} {'training_iteration': 2} 
1017 12:41:22 compiler_gym.service.connection] Exec `./example_service.py --working_dir=/dev/shm/compiler_gym_dejang/s/1017T124122-362459-c6a1 --alsologtostderr -v=1 --logbuflevel=-1`
1017 12:41:25 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/012345
Number of benchmarks for training: 576
Number of benchmarks for validation: 144
1017 12:41:26 compiler_gym.service.connection] Exec `./example_service.py --working_dir=/dev/shm/compiler_gym_dejang/s/1017T124125-998148-21a5 --alsologtostderr -v=1 --logbuflevel=-1`
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/012345
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/102435
benchmark://mm32_8_16_8_4_16-v0/102435
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Ending session 0
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/234501
benchmark://mm32_8_16_8_4_16-v0/234501
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Ending session 1
1017 12:41:29 compiler_gym.service.client_service_compiler_env] Setting benchmark: benchmark://mm32_8_16_8_4_16-v0/405213
benchmark://mm32_8_16_8_4_16-v0/405213
hhh1______________________
Before tune.run, stop = {'training_iteration': 2}
== Status ==
Current time: 2022-10-17 12:41:30 (running for 00:00:00.21)
Memory usage on this node: 80.3/503.8 GiB
Using FIFO scheduling algorithm.
Resources requested: 0/80 CPUs, 0/1 GPUs, 0.0/291.92 GiB heap, 0.0/129.1 GiB objects (0.0/1.0 accelerator_type:V100)
Result logdir: /private/home/dejang/ray_results/PPO_2022-10-17_12-41-29
Number of trials: 1/1 (1 PENDING)
+------------------------------+----------+-------+
| Trial name                   | status   | loc   |
|------------------------------+----------+-------|
| PPO_compiler_gym_b2470_00000 | PENDING  |       |
+------------------------------+----------+-------+


1017 12:41:31 git.cmd] Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/private/home/dejang/tools/cg_rllib_slurm, universal_newlines=False, shell=None, istream=None)
1017 12:41:34 urllib3.connectionpool] Starting new HTTPS connection (1): api.wandb.ai:443
1017 12:41:34 urllib3.connectionpool] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 521
1017 12:41:34 urllib3.connectionpool] Starting new HTTPS connection (1): api.wandb.ai:443
1017 12:41:34 urllib3.connectionpool] https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 325
1017 12:41:34 git.cmd] Popen(['git', 'cat-file', '--batch-check'], cwd=/private/home/dejang/tools/cg_rllib_slurm, universal_newlines=False, shell=None, istream=<valid stream>)
1017 12:42:35 urllib3.connectionpool] Starting new HTTPS connection (1): o151352.ingest.sentry.io:443
1017 12:42:35 urllib3.connectionpool] https://o151352.ingest.sentry.io:443 "POST /api/5288891/envelope/ HTTP/1.1" 200 2
